<html>
  <head>
    <!--Load the AJAX API-->
    {% load static %}
    <link rel="stylesheet" href="{% static 'core/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'core/main.css' %}">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script>
    <script type="text/javascript">

      // Load the Visualization API and the corechart package.
      google.charts.load('current', {'packages':['corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(drawChart);

      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
      function drawChart() {

        // Create the data table.
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Name');
        data.addColumn('number', 'Total # of Interventions By Format- {{from_time }} - {{to_time }}');
        data.addColumn({type: 'string', role: 'annotation'});
        data.addRows([
          ['Phone', {{phone}}, '{{phone}}'],
          ['Visit', {{unreachable}}, '{{unreachable}}'],
          ['In-Person', {{in_person}}, '{{in_person}}'],
          ['Email', {{email}}, '{{email}}'],
          ]);

        // Set chart options
        var options = {
           'title':`Total # of Interventions Done by Formt
                Date Range: {{from_time}} - {{to_time}}
                Name of Teacher: {{request.user.first_name}} {{request.user.last_name}}
                Report for {{student_name}}
           `,
            sliceVisibilityThreshold:0,
            width:800,
            height: 800,
            legend: { position: 'bottom', alignment: 'center' },
        };

        // Instantiate and draw our chart, passing in some options.
        var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
        document.getElementById('save-pdf').addEventListener('click', function() {
            var doc = new jsPDF();
            chart.setSelection([])
            doc.addImage(chart.getImageURI(), 12, 20);
            doc.save('Total # of Interventions Done by Status.pdf')
        }, false);
        chart.draw(data, options);
      }

    </script>
  </head>

    <div align="center" style="margin: auto; margin-top:100px; width:800px; height:600px;">
      <div style="font-size:24px;margin:20px; font-weight: bold;">
          Total Number of Interventions Done by Format
      </div>
      <div id="chart_div">
      </div>
      <button type="button" id="save-pdf" class="btn btn-primary">Download as PDF</button>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
</html>