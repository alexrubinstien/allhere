<html>
  <head>
    <!--Load the AJAX API-->
    {% load static %}
    <link rel="stylesheet" href="{% static 'core/bootstrap.min.css' %}">
    <link rel="stylesheet" href="{% static 'core/main.css' %}">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.5/jspdf.min.js"></script>
    <script type="text/javascript">

      // Load the Visualization API and the corechart package.
      google.charts.load('current', {'packages':['corechart']});

      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(drawChart);

      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
        function drawChart() {
            var data = new google.visualization.DataTable();
            data.addColumn('string', 'Success Score'); // Implicit domain column.
            var row = ['Success Rating']
            {% for score in scores %}
                data.addColumn('number', '{{forloop.counter}}')
                data.addColumn({type: 'string', role: 'annotation'});
                row.push({{score}})
                row.push('{{score}}')
            {% endfor %}
            // data.addColumn('number', 'Sales'); // Implicit data column.
            // data.addColumn('number', 'Expenses');
            data.addRows([
                row
            ]);

            var options = {
            'title':`Total # of Interventions Done by Success Score
                Name of Teacher: {{request.user.first_name}} {{request.user.last_name}}
                Date Range: {{from_time}} - {{to_time}}
                Report for {{student_name}}
            `,
           
        
            width:1200,
            height: 800,
            legend: { position: 'bottom', alignment: 'center' },
        };
            var chart = new google.visualization.ColumnChart(
                        document.getElementById('chart_div'));
            chart.draw(data, options);
        
      document.getElementById('save-pdf').addEventListener('click', function() {
            var doc = new jsPDF("p", "mm", 'a4');
            chart.setSelection([]);
            doc.addImage(chart.getImageURI(), 0,30, 220, 150);
            doc.save('Total # of Interventions Done by Success Score.pdf')
        }, false);
    }
    </script>
  </head>

    <div align="center" style="margin: auto; margin-top:50px; width:1200px; height:600px;">
      <div style="font-size:24px;margin:20px; font-weight: bold;">
          Total Number of Interventions Done by Success Score
      </div>
      <div id="chart_div">
      </div>
      <button type="button" id="save-pdf" class="btn btn-primary">Download as PDF</button>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js" integrity="sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1" crossorigin="anonymous"></script>
</html>